{
 "properties": {
  "displayName": "Allowed Products Networks (Deny)",
  "policyType": "Custom",
  "mode": "All",
  "metadata": {
   "version": "1.0.0",
   "category": "Bespoke",
   "createdBy": "2efb06de-97f9-4810-bb7e-2543007ac4a5",
   "createdOn": "2022-01-13T15:30:05.945756Z",
   "updatedBy": "cbd7944c-a57e-4d90-92a0-b40d55a95e38",
   "updatedOn": "2022-02-07T15:27:20.9407121Z"
  },
  "parameters": {},
  "policyRule": {
   "if": {
    "not": {
     "field": "type",
     "in": [
      "Microsoft.Authorization/checkAccess",
      "Microsoft.Authorization/classicAdministrators",
      "Microsoft.Authorization/denyAssignments",
      "Microsoft.Authorization/elevateAccess",
      "Microsoft.Authorization/locks",
      "Microsoft.Authorization/operations",
      "Microsoft.Authorization/permissions",
      "Microsoft.Authorization/policyAssignments",
      "Microsoft.Authorization/policyDefinitions",
      "Microsoft.Authorization/policyExemptions",
      "Microsoft.Authorization/policySetDefinitions",
      "Microsoft.Authorization/providerOperations",
      "Microsoft.Authorization/roleAssignments",
      "Microsoft.Authorization/roleDefinitions",
      "Microsoft.Network/applicationGatewayAvailableWafRuleSets",
      "Microsoft.Network/applicationGateways",
      "Microsoft.Network/applicationSecurityGroups",
      "Microsoft.Network/connections",
      "Microsoft.Network/dnszones",
      "Microsoft.Network/dnszones/NS",
      "Microsoft.Network/dnszones/SOA",
      "Microsoft.Network/expressRouteCircuits",
      "Microsoft.Network/expressRouteServiceProviders",
      "Microsoft.Network/loadBalancers",
      "Microsoft.Network/loadBalancers/backendAddressPools",
      "Microsoft.Network/networkInterfaces",
      "Microsoft.Network/networkSecurityGroups",
      "Microsoft.Network/networkSecurityGroups/securityRules",
      "Microsoft.Network/networkWatchers",
      "Microsoft.Network/networkWatchers/flowLogs",
      "Microsoft.Network/privateDnsZones",
      "Microsoft.Network/privateDnsZones/A",
      "Microsoft.Network/privateDnsZones/SOA",
      "Microsoft.Network/privateDnsZones/virtualNetworkLinks",
      "Microsoft.Network/privateEndpoints",
      "Microsoft.Network/privateEndpoints/manualprivateLinkServiceConnections",
      "Microsoft.Network/privateEndpoints/privateDnsZoneGroups",
      "Microsoft.Network/privateEndpoints/privateLinkServiceProxies",
      "Microsoft.Network/publicIPAddresses",
      "Microsoft.Network/routeFilters",
      "Microsoft.Network/routeTables",
      "Microsoft.Network/routeTables/routes",
      "Microsoft.Network/routeTables/routes/write",
      "Microsoft.Network/trafficmanagerprofiles",
      "Microsoft.Network/virtualNetworkGateways",
      "Microsoft.Network/virtualNetworkPeerings",
      "Microsoft.Network/virtualNetworks",
      "Microsoft.Network/virtualNetworks/remoteVirtualNetworkPeeringProxies",
      "Microsoft.Network/virtualNetworks/subnets",
      "Microsoft.Network/virtualNetworks/subnets/serviceAssociationLinks",
      "Microsoft.Network/virtualNetworks/subnets/resourceNavigationLinks",
      "Microsoft.Network/virtualNetworks/taggedTrafficConsumers",
      "Microsoft.Network/virtualNetworks/virtualNetworkPeerings",
      "Microsoft.PolicyInsights/remediations"
     ]
    }
   },
   "then": {
    "effect": "deny"
   }
  }
 },
 "id": "/providers/Microsoft.Management/managementGroups/Prod/providers/Microsoft.Authorization/policyDefinitions/deploy_allowed_products_networks",
 "type": "Microsoft.Authorization/policyDefinitions",
 "name": "deploy_allowed_products_networks"
}